import{o as e,p as t}from"./index-D64fSWen.js";import{M as s}from"./index-yWgYGWn4.js";import{S as i}from"./index-BVzpzorU.js";import{C as l}from"./AntdIcon-BrIVTVC9.js";import{D as r}from"./index-DQw-pPfg.js";import{T as n}from"./index-DU3lSUt0.js";import{T as a}from"./index-OFQobG-o.js";import{R as o,C as c}from"./row-KUrmra0O.js";import{S as d}from"./index-CNaFVlZv.js";import{D as x}from"./index-B-qYguWh.js";import{R as j}from"./CloseOutlined-B--xzqQ7.js";import{r as h}from"./react-vendor-B_j1QKL9.js";import{g as m,a as p}from"./associations-CJwh2Lxw.js";import{A as u,l as g}from"./config-C-P0NNBq.js";import{s as f}from"./index-CNd4JuwY.js";import{B as y}from"./EllipsisOutlined-B7G7Lika.js";import{R as v}from"./TeamOutlined--sib1hVJ.js";import{R as S}from"./CrownOutlined-C1NA_heS.js";import{R as T}from"./BankOutlined-DsUBx9Up.js";import{R as b}from"./FireOutlined-iSvRmuP2.js";import{I as w}from"./index-Ba3ggKkW.js";import{F as C}from"./Table-CcmlabOw.js";import{T as A}from"./index-ChgZ5ieq.js";import{R as I}from"./EyeOutlined-DyWz_EC7.js";import"./ExclamationCircleFilled-DT70Ahrp.js";import"./InfoCircleFilled-CZmHaujc.js";import"./context-C6B8do_o.js";import"./DownOutlined-CLoAI_il.js";import"./EditOutlined-jOoJX1ad.js";import"./CheckOutlined-BLh5wKOq.js";import"./TextArea-RvXwFgUf.js";import"./index-GvAVA_fY.js";const k=({associationDetailVisible:t,setAssociationDetailVisible:h,selectedAssociation:m,getAssociationType:p,getLevelName:u})=>{var g,f,y,v,S,T;return e.jsx(s,{title:e.jsx(a.Text,{strong:!0,children:"宗门详情"}),open:t,onCancel:()=>h(!1),footer:null,closeIcon:e.jsx(j,{}),width:800,children:m&&e.jsxs(i,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsx(l,{title:e.jsx(a.Text,{strong:!0,children:"基础信息"}),bordered:!0,children:e.jsxs(r,{column:2,labelStyle:{width:120},children:[e.jsx(r.Item,{label:"宗门名称",children:m.宗门名称}),e.jsx(r.Item,{label:"宗门等级",children:m.宗门等级}),e.jsx(r.Item,{label:"宗主",children:m.宗主}),e.jsx(r.Item,{label:"宗门类型",children:e.jsx(n,{color:m.power>0?"purple":"blue",children:p(m.power)})}),e.jsx(r.Item,{label:"最低加入境界",children:u(m.最低加入境界)}),e.jsx(r.Item,{label:"创立时间",children:(null==(g=m.创立时间)?void 0:g[0])??"未知"})]})}),e.jsx(l,{title:e.jsx(a.Text,{strong:!0,children:"成员信息"}),bordered:!0,children:e.jsxs(o,{gutter:[16,16],children:[e.jsx(c,{xs:24,sm:12,md:8,children:e.jsx(d,{title:"总成员数",value:(null==(f=m.所有成员)?void 0:f.length)??0})}),e.jsx(c,{xs:24,sm:12,md:8,children:e.jsx(d,{title:"副宗主数",value:(null==(y=m.副宗主)?void 0:y.length)??0})}),e.jsx(c,{xs:24,sm:12,md:8,children:e.jsx(d,{title:"长老数",value:(null==(v=m.长老)?void 0:v.length)??0})}),e.jsx(c,{xs:24,sm:12,md:8,children:e.jsx(d,{title:"内门弟子数",value:(null==(S=m.内门弟子)?void 0:S.length)??0})}),e.jsx(c,{xs:24,sm:12,md:8,children:e.jsx(d,{title:"外门弟子数",value:(null==(T=m.外门弟子)?void 0:T.length)??0})})]})}),e.jsxs(l,{title:e.jsx(a.Text,{strong:!0,children:"资源信息"}),bordered:!0,children:[e.jsxs(o,{gutter:[16,16],children:[e.jsx(c,{xs:24,sm:12,md:8,children:e.jsx(d,{title:"灵石池",value:m.灵石池??0})}),e.jsx(c,{xs:24,sm:12,md:8,children:e.jsx(d,{title:"大阵血量",value:m.大阵血量??0})})]}),e.jsx(x,{style:{margin:"16px 0"}}),e.jsxs(r,{column:2,labelStyle:{width:120},children:[e.jsx(r.Item,{label:"宗门驻地",children:m.宗门驻地??"无驻地"}),e.jsx(r.Item,{label:"宗门神兽",children:m.宗门神兽??"无"}),e.jsx(r.Item,{label:"维护时间",children:m.维护时间?new Date(m.维护时间).toLocaleString():"-"})]})]})]})})},z=()=>{const{associations:s,loading:r,searchText:x,selectedAssociation:j,associationDetailVisible:z,pagination:D,stats:L,fetchAssociations:O,handleSearchAndFilter:V,handleTableChange:E,getAssociationType:F,getLevelName:M,setSearchText:R,setSelectedAssociation:N,setAssociationDetailVisible:$}=(()=>{const{user:e}=t(),[s,i]=h.useState([]),[l,r]=h.useState(!1),[n,a]=h.useState(""),[o,c]=h.useState(null),[d,x]=h.useState(!1),[j,y]=h.useState({current:1,pageSize:u,total:0,totalPages:0}),[v,S]=h.useState({total:0,totalMembers:0,totalPower:0,totalLingshi:0,xianjieCount:0,fanjieCount:0}),T=async(t=1,s=u)=>{if(e){r(!0);try{if(!localStorage.getItem("token"))return void f.error("未找到登录令牌");const e=await m({page:t,pageSize:s,search:n});e.success&&e.data?(i(e.data.list),y(e.data.pagination)):f.error(e.message??"获取宗门数据失败")}catch(l){f.error("获取宗门数据失败")}finally{r(!1)}}},b=async()=>{if(e)try{if(!localStorage.getItem("token"))return void f.error("未找到登录令牌");const e=await p({search:n});e.success&&e.data&&S(e.data)}catch(t){}};return h.useEffect(()=>{T(1,u),b()},[e]),{associations:s,loading:l,searchText:n,selectedAssociation:o,associationDetailVisible:d,pagination:j,stats:v,fetchAssociations:T,fetchStats:b,handleSearchAndFilter:()=>{T(1,j.pageSize),b()},handleTableChange:(e,t)=>{T(e,t)},getLevelName:e=>g[e]??`境界${e}`,getAssociationType:e=>e>0?"仙界":"凡界",setSearchText:a,setSelectedAssociation:c,setAssociationDetailVisible:x}})(),B=[{title:"宗门信息",key:"associationInfo",width:280,render:(t,s)=>e.jsxs(i,{direction:"vertical",size:2,children:[e.jsx(a.Text,{strong:!0,children:s.宗门名称}),e.jsxs(a.Text,{type:"secondary",children:["等级: ",s.宗门等级]}),e.jsxs(a.Text,{type:"secondary",children:["宗主: ",s.宗主]})]})},{title:"宗门类型",key:"type",width:120,render:(t,s)=>e.jsx(n,{color:s.power>0?"purple":"blue",children:F(s.power)})},{title:"成员统计",key:"members",width:180,render:(t,s)=>{var l,r,n;return e.jsxs(i,{direction:"vertical",size:0,children:[e.jsxs(a.Text,{children:["总成员：",((null==(l=s.所有成员)?void 0:l.length)??0).toLocaleString()]}),e.jsxs(a.Text,{children:["副宗主：",((null==(r=s.副宗主)?void 0:r.length)??0).toLocaleString()]}),e.jsxs(a.Text,{children:["长老：",((null==(n=s.长老)?void 0:n.length)??0).toLocaleString()]})]})}},{title:"资源信息",key:"resources",width:160,render:(t,s)=>e.jsxs(i,{direction:"vertical",size:0,children:[e.jsxs(a.Text,{children:["灵石池：",(s.灵石池??0).toLocaleString()]}),e.jsxs(a.Text,{children:["大阵血量：",(s.大阵血量??0).toLocaleString()]}),e.jsxs(a.Text,{children:["最低境界：",M(s.最低加入境界)]})]})},{title:"宗门驻地",key:"location",width:140,render:(t,s)=>e.jsxs(i,{direction:"vertical",size:0,children:[e.jsxs(a.Text,{children:["驻地：",s.宗门驻地??"无驻地"]}),e.jsxs(a.Text,{children:["神兽：",s.宗门神兽??"无"]})]})},{title:"操作",key:"actions",width:120,render:(t,s)=>e.jsx(A,{title:"查看详情",placement:"top",children:e.jsx(y,{type:"primary",icon:e.jsx(I,{}),onClick:()=>{N(s),$(!0)},children:"查看"})})}];return e.jsxs(i,{direction:"vertical",size:"large",className:"bg-slate-200 p-4",style:{width:"100%"},children:[e.jsx(l,{title:e.jsxs(i,{align:"center",children:[e.jsx(v,{}),e.jsx(a.Text,{strong:!0,children:"宗门管理"})]}),extra:e.jsx(y,{type:"primary",loading:r,onClick:()=>{O(1,D.pageSize)},children:"刷新"}),children:e.jsx(a.Text,{type:"secondary",children:"管理修仙世界的宗门信息"})}),e.jsxs(o,{gutter:[16,16],children:[e.jsx(c,{xs:24,md:6,children:e.jsxs(l,{children:[e.jsx(d,{title:"总宗门数",value:L.total??0,prefix:e.jsx(v,{})}),e.jsxs(a.Text,{type:"secondary",children:["仙界: ",L.xianjieCount??0," | 凡界: ",L.fanjieCount??0]})]})}),e.jsx(c,{xs:24,md:6,children:e.jsxs(l,{children:[e.jsx(d,{title:"仙界宗门",value:L.xianjieCount??0,prefix:e.jsx(S,{})}),e.jsxs(a.Text,{type:"secondary",children:["占比: ",L.total?Math.round(L.xianjieCount/L.total*100):0,"%"]})]})}),e.jsx(c,{xs:24,md:6,children:e.jsxs(l,{children:[e.jsx(d,{title:"总灵石池",value:L.totalLingshi??0,prefix:e.jsx(T,{})}),e.jsxs(a.Text,{type:"secondary",children:["平均: ",L.total?Math.round(L.totalLingshi/L.total):0]})]})}),e.jsx(c,{xs:24,md:6,children:e.jsxs(l,{children:[e.jsx(d,{title:"总成员数",value:L.totalMembers??0,prefix:e.jsx(b,{})}),e.jsxs(a.Text,{type:"secondary",children:["平均: ",L.total?Math.round(L.totalMembers/L.total):0]})]})})]}),e.jsx(w.Search,{placeholder:"搜索宗门名称、宗主或驻地...",value:x,onChange:e=>R(e.target.value),onSearch:()=>{V()},onPressEnter:()=>{V()},allowClear:!0}),e.jsx(l,{title:"宗门列表",children:e.jsx(C,{columns:B,dataSource:s,rowKey:"宗门名称",loading:r,pagination:{current:D.current,pageSize:D.pageSize,total:D.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`第 ${t[0]}-${t[1]} 条，共 ${e} 条`},onChange:e=>{E(e.current,e.pageSize)},scroll:{x:1e3}})}),e.jsx(k,{associationDetailVisible:z,setAssociationDetailVisible:$,selectedAssociation:j,getAssociationType:F,getLevelName:M})]})};export{z as default};
