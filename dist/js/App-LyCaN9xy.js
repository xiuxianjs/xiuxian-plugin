import{d as e,j as t}from"./index-B9mLjpt3.js";import{r as s}from"./react-vendor-BsLSO1-h.js";import{d as a}from"./dayjs.min-Ckz3TLWH.js";import{B as r,I as l,S as i}from"./XiuxianUserSelector-Cv7HvdtT.js";import{X as n}from"./XiuxianStatCard-tZoCMgVa.js";import{X as o}from"./XiuxianPageWrapper-BZROkx5B.js";import{X as c}from"./XiuxianPageTitle-BrZ5mb3D.js";import{X as d}from"./XiuxianTableContainer-C9x-fT4S.js";import{X as x}from"./XiuxianRefreshButton-CH-kE1xv.js";import{X as m}from"./XiuxianEmptyState-BkwrAbQx.js";import{X as p}from"./XiuxianTableWithPagination-CPdaymVz.js";import{F as h}from"./index-B0nP5e1S.js";import{R as u}from"./PlusOutlined-UkspXFXG.js";import{R as j,P as g}from"./StopOutlined-YwDQBM6r.js";import{I as f,S as v,T as y}from"./AntdIcon-D2s3_BnZ.js";import{R as b,a as N}from"./ExclamationCircleOutlined-CZz0bWQA.js";import{R as w}from"./CheckCircleOutlined-JLtk_3Dz.js";import{R as S}from"./DeleteOutlined-esplibMF.js";import{R as I}from"./EyeOutlined-BDuMJPmV.js";import{M as k}from"./index-DJXgZWHj.js";import{R as C,C as T}from"./row-B43XsJyz.js";import{s as O}from"./index-DG5U-29d.js";import{T as z}from"./index-jPZUbwh3.js";import{R as X}from"./UserOutlined-DDMUowk8.js";import"./PlusOutlined-ByZyTB3m.js";import"./index-CHWBmS26.js";import"./context-_dVsAOM1.js";import"./index-Dw5ZynFm.js";var E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},P.apply(this,arguments)}const R=(e,t)=>s.createElement(f,P({},e,{ref:t,icon:E})),D=s.forwardRef(R);var L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"};function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},M.apply(this,arguments)}const $=(e,t)=>s.createElement(f,M({},e,{ref:t,icon:L})),A=s.forwardRef($),{TextArea:B}=l,{Option:q}=i,F=()=>{const[f,E]=s.useState(null),[P,R]=s.useState(null),[L,M]=s.useState(!1),[$,F]=s.useState(!1),[H]=h.useForm(),[Y,G]=s.useState(""),[U,V]=s.useState({current:1,pageSize:10,total:0}),W=async()=>{try{const s=await(t={global:!0},e({url:"/message-stats",method:"GET",params:t}));R(s.data)}catch(s){O.error("Ëé∑ÂèñÁªüËÆ°‰ø°ÊÅØÂ§±Ë¥•")}var t},J=async(t,s=1,a=10)=>{if(t){M(!0);try{const l=await(r={userId:t,page:s,pageSize:a},e({url:"/messages",method:"GET",params:r}));E(l.data),V({current:l.data.page,pageSize:l.data.pageSize,total:l.data.total})}catch(l){O.error("Ëé∑ÂèñÊ∂àÊÅØÂàóË°®Â§±Ë¥•")}finally{M(!1)}var r}},K=async(t,s)=>{try{await(a={userId:t,messageId:s},e({url:"/messages",method:"DELETE",data:a})),O.success("Âà†Èô§ÊàêÂäü"),J(t,U.current,U.pageSize)}catch(r){O.error("Âà†Èô§Â§±Ë¥•")}var a},Q=[{title:t.jsxs("div",{className:"flex items-center gap-2 text-purple-400 font-bold",children:[t.jsx(D,{className:"text-lg"}),t.jsx("span",{children:"Ê∂àÊÅØÊ†áÈ¢ò"})]}),dataIndex:"title",key:"title",width:200,ellipsis:!0,render:e=>t.jsx("span",{className:"text-white font-medium",children:e})},{title:t.jsx("div",{className:"flex items-center gap-2 text-blue-400 font-bold",children:t.jsx("span",{children:"Ê∂àÊÅØÂÜÖÂÆπ"})}),dataIndex:"content",key:"content",width:300,ellipsis:!0,render:e=>t.jsx(y,{title:e,children:t.jsx("span",{className:"text-slate-300",children:e.length>50?`${e.substring(0,50)}...`:e})})},{title:t.jsx("div",{className:"flex items-center gap-2 text-orange-400 font-bold",children:t.jsx("span",{children:"Ê∂àÊÅØÁ±ªÂûã"})}),dataIndex:"type",key:"type",width:120,render:e=>{const s={system:{color:"blue",text:"Á≥ªÁªüÊ∂àÊÅØ"},announcement:{color:"red",text:"ÂÖ¨Âëä"},reward:{color:"green",text:"Â•ñÂä±ÈÄöÁü•"},activity:{color:"orange",text:"Ê¥ªÂä®ÈÄöÁü•"},personal:{color:"purple",text:"‰∏™‰∫∫Ê∂àÊÅØ"}}[e]||{color:"default",text:e};return t.jsx(z,{color:s.color,children:s.text})}},{title:t.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 font-bold",children:[t.jsx(b,{className:"text-lg"}),t.jsx("span",{children:"‰ºòÂÖàÁ∫ß"})]}),dataIndex:"priority",key:"priority",width:100,render:e=>{const s={1:{color:"default",text:"‰Ωé"},2:{color:"blue",text:"ÊôÆÈÄö"},3:{color:"orange",text:"È´ò"},4:{color:"red",text:"Á¥ßÊÄ•"}}[e]||{color:"default",text:"ÊôÆÈÄö"};return t.jsx(z,{color:s.color,children:s.text})}},{title:t.jsxs("div",{className:"flex items-center gap-2 text-green-400 font-bold",children:[t.jsx(w,{className:"text-lg"}),t.jsx("span",{children:"Áä∂ÊÄÅ"})]}),dataIndex:"status",key:"status",width:100,render:e=>{const s={0:{color:"red",text:"Êú™ËØª"},1:{color:"green",text:"Â∑≤ËØª"},2:{color:"default",text:"Â∑≤Âà†Èô§"}}[e]||{color:"default",text:"Êú™Áü•"};return t.jsx(z,{color:s.color,children:s.text})}},{title:t.jsxs("div",{className:"flex items-center gap-2 text-cyan-400 font-bold",children:[t.jsx(X,{className:"text-lg"}),t.jsx("span",{children:"ÂèëÈÄÅËÄÖ"})]}),dataIndex:"senderName",key:"senderName",width:120,render:e=>t.jsx("span",{className:"text-slate-300",children:e||"Á≥ªÁªü"})},{title:t.jsxs("div",{className:"flex items-center gap-2 text-pink-400 font-bold",children:[t.jsx(N,{className:"text-lg"}),t.jsx("span",{children:"ÂàõÂª∫Êó∂Èó¥"})]}),dataIndex:"createTime",key:"createTime",width:180,render:e=>t.jsx("span",{className:"text-slate-400 text-sm",children:a(e).format("YYYY-MM-DD HH:mm:ss")})},{title:t.jsx("div",{className:"flex items-center gap-2 text-red-400 font-bold",children:t.jsx("span",{children:"Êìç‰Ωú"})}),key:"action",width:120,render:(e,s)=>t.jsx(v,{children:t.jsx(g,{title:"Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°Ê∂àÊÅØÂêóÔºü",onConfirm:()=>K(Y,s.id),okText:"Á°ÆÂÆö",cancelText:"ÂèñÊ∂à",children:t.jsx(r,{type:"text",size:"small",icon:t.jsx(S,{}),className:"text-red-400 hover:text-red-300 hover:bg-red-400/10",children:"Âà†Èô§"})})})}];return s.useEffect(()=>{W()},[]),t.jsxs(o,{children:[t.jsx(c,{icon:t.jsx(D,{}),title:"Á´ôÂÜÖ‰ø°ÁÆ°ÁêÜ",subtitle:"ÁÆ°ÁêÜ‰øÆ‰ªôÁïåÈÅìÂèãÁöÑÁ´ôÂÜÖ‰ø°Á≥ªÁªü",actions:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(r,{type:"primary",icon:t.jsx(u,{}),onClick:()=>F(!0),className:"bg-gradient-to-r from-purple-500 to-pink-500 border-0 hover:from-purple-600 hover:to-pink-600",children:"ÂèëÈÄÅÊ∂àÊÅØ"}),t.jsx(r,{danger:!0,icon:t.jsx(j,{}),onClick:async()=>{try{const t=await e({url:"/message-stats",method:"POST"});O.success(`Ê∏ÖÁêÜÊàêÂäüÔºåÂÖ±Ê∏ÖÁêÜ ${t.data.cleanedCount} Êù°ËøáÊúüÊ∂àÊÅØ`),W()}catch(t){O.error("Ê∏ÖÁêÜÂ§±Ë¥•")}},className:"hover:bg-red-600",children:"Ê∏ÖÁêÜËøáÊúü"}),t.jsx(x,{loading:L,onClick:()=>{W(),Y&&J(Y,U.current,U.pageSize)}})]})}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsx(n,{title:"ÊÄªÊ∂àÊÅØÊï∞",value:((null==P?void 0:P.total)||0).toLocaleString(),icon:t.jsx(D,{}),gradient:"blue"}),t.jsx(n,{title:"Êú™ËØªÊ∂àÊÅØ",value:((null==P?void 0:P.unread)||0).toLocaleString(),icon:t.jsx(b,{}),gradient:"red"}),t.jsx(n,{title:"Â∑≤ËØªÊ∂àÊÅØ",value:((null==P?void 0:P.read)||0).toLocaleString(),icon:t.jsx(w,{}),gradient:"green"}),t.jsx(n,{title:"Â∑≤Âà†Èô§Ê∂àÊÅØ",value:((null==P?void 0:P.deleted)||0).toLocaleString(),icon:t.jsx(S,{}),gradient:"purple"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-6 shadow-lg",children:[t.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[t.jsx(I,{className:"text-blue-400"}),"Êü•ÁúãÁî®Êà∑Ê∂àÊÅØ"]}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx(l,{placeholder:"ËæìÂÖ•Áî®Êà∑IDÊü•ÁúãÊ∂àÊÅØ...",value:Y,onChange:e=>G(e.target.value),className:"xiuxian-input flex-1",onPressEnter:()=>J(Y)}),t.jsx(r,{type:"primary",icon:t.jsx(I,{}),onClick:()=>J(Y),disabled:!Y,className:"bg-gradient-to-r from-blue-500 to-cyan-500 border-0 hover:from-blue-600 hover:to-cyan-600",children:"Êü•ÁúãÊ∂àÊÅØ"})]})]}),t.jsx(d,{title:"Ê∂àÊÅØÂàóË°®",icon:t.jsx(D,{}),children:Y?0===(null==f?void 0:f.messages.length)?t.jsx(m,{icon:"üì≠",title:"ÊöÇÊó†Ê∂àÊÅØ",description:"ËØ•Áî®Êà∑ÁõÆÂâçÊ≤°Êúâ‰ªª‰ΩïÊ∂àÊÅØËÆ∞ÂΩï"}):t.jsx(p,{columns:Q,dataSource:(null==f?void 0:f.messages)||[],rowKey:"id",loading:L,pagination:{current:U.current,pageSize:U.pageSize,total:U.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`Á¨¨ ${t[0]}-${t[1]} Êù°ÔºåÂÖ± ${e} Êù°`},onPaginationChange:(e,t)=>{J(Y,e,t||10)},rowClassName:()=>"hover:bg-gradient-to-r hover:from-purple-500/10 hover:to-blue-500/10 transition-all duration-300 bg-slate-700 hover:bg-slate-600"}):t.jsx(m,{icon:"üìù",title:"ËØ∑ÂÖàËæìÂÖ•Áî®Êà∑ID",description:"Âú®‰∏äÊñπËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ•Áî®Êà∑IDÊù•Êü•ÁúãËØ•Áî®Êà∑ÁöÑÊ∂àÊÅØÂàóË°®"})})]}),t.jsx(k,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(A,{className:"text-purple-400"}),t.jsx("span",{className:"text-white",children:"ÂèëÈÄÅÁ´ôÂÜÖ‰ø°"})]}),open:$,onCancel:()=>F(!1),footer:null,className:"xiuxian-modal",width:600,children:t.jsxs(h,{form:H,layout:"vertical",onFinish:async t=>{try{const s={title:t.title,content:t.content,type:t.type,priority:t.priority||2,receivers:t.receivers?t.receivers.split(",").map(e=>e.trim()):[],expireTime:t.expireTime?new Date(t.expireTime).getTime():void 0};await(t=>e({url:"/messages",method:"POST",data:t}))(s),O.success("Ê∂àÊÅØÂèëÈÄÅÊàêÂäü"),F(!1),H.resetFields(),W()}catch(s){O.error("ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•")}},initialValues:{type:"system",priority:2},className:"mt-4",children:[t.jsx(h.Item,{name:"title",label:t.jsx("span",{className:"text-slate-300",children:"Ê∂àÊÅØÊ†áÈ¢ò"}),rules:[{required:!0,message:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÊ†áÈ¢ò"}],children:t.jsx(l,{placeholder:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÊ†áÈ¢ò",className:"xiuxian-input"})}),t.jsx(h.Item,{name:"content",label:t.jsx("span",{className:"text-slate-300",children:"Ê∂àÊÅØÂÜÖÂÆπ"}),rules:[{required:!0,message:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÂÜÖÂÆπ"}],children:t.jsx(B,{rows:4,placeholder:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÂÜÖÂÆπ",className:"xiuxian-input"})}),t.jsxs(C,{gutter:16,children:[t.jsx(T,{span:12,children:t.jsx(h.Item,{name:"type",label:t.jsx("span",{className:"text-slate-300",children:"Ê∂àÊÅØÁ±ªÂûã"}),rules:[{required:!0,message:"ËØ∑ÈÄâÊã©Ê∂àÊÅØÁ±ªÂûã"}],children:t.jsxs(i,{placeholder:"ËØ∑ÈÄâÊã©Ê∂àÊÅØÁ±ªÂûã",className:"xiuxian-select",children:[t.jsx(q,{value:"system",children:"Á≥ªÁªüÊ∂àÊÅØ"}),t.jsx(q,{value:"announcement",children:"ÂÖ¨Âëä"}),t.jsx(q,{value:"reward",children:"Â•ñÂä±ÈÄöÁü•"}),t.jsx(q,{value:"activity",children:"Ê¥ªÂä®ÈÄöÁü•"}),t.jsx(q,{value:"personal",children:"‰∏™‰∫∫Ê∂àÊÅØ"})]})})}),t.jsx(T,{span:12,children:t.jsx(h.Item,{name:"priority",label:t.jsx("span",{className:"text-slate-300",children:"‰ºòÂÖàÁ∫ß"}),rules:[{required:!0,message:"ËØ∑ÈÄâÊã©‰ºòÂÖàÁ∫ß"}],children:t.jsxs(i,{placeholder:"ËØ∑ÈÄâÊã©‰ºòÂÖàÁ∫ß",className:"xiuxian-select",children:[t.jsx(q,{value:1,children:"‰Ωé"}),t.jsx(q,{value:2,children:"ÊôÆÈÄö"}),t.jsx(q,{value:3,children:"È´ò"}),t.jsx(q,{value:4,children:"Á¥ßÊÄ•"})]})})})]}),t.jsx(h.Item,{name:"receivers",label:t.jsx("span",{className:"text-slate-300",children:"Êé•Êî∂ËÄÖID"}),extra:t.jsx("span",{className:"text-slate-500",children:"Â§ö‰∏™Áî®Êà∑IDÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÁïôÁ©∫Ë°®Á§∫ÂÖ®ÊúçÂèëÈÄÅ"}),children:t.jsx(l,{placeholder:"‰æãÂ¶Ç: 123456,789012",className:"xiuxian-input"})}),t.jsx(h.Item,{name:"expireTime",label:t.jsx("span",{className:"text-slate-300",children:"ËøáÊúüÊó∂Èó¥"}),extra:t.jsx("span",{className:"text-slate-500",children:"ÂèØÈÄâÔºåÁïôÁ©∫Ë°®Á§∫Ê∞∏‰∏çËøáÊúü"}),children:t.jsx(l,{type:"datetime-local",className:"xiuxian-input"})}),t.jsx(h.Item,{children:t.jsxs(v,{children:[t.jsx(r,{type:"primary",htmlType:"submit",icon:t.jsx(A,{}),className:"bg-gradient-to-r from-purple-500 to-pink-500 border-0 hover:from-purple-600 hover:to-pink-600",children:"ÂèëÈÄÅ"}),t.jsx(r,{onClick:()=>F(!1),className:"bg-slate-700 hover:bg-slate-600 border-slate-600",children:"ÂèñÊ∂à"})]})})]})})]})};export{F as default};
