import{p as e,o as s}from"./index-D64fSWen.js";import{l as t}from"./config-C-P0NNBq.js";import{r as i}from"./react-vendor-B_j1QKL9.js";import{a as r}from"./associations-CJwh2Lxw.js";import{g as a}from"./game-users-DuyIM_qg.js";import{g as n}from"./rankings-BwgxydrH.js";import{a as l}from"./tasks-_gXZDWeU.js";import{S as o}from"./index-BVzpzorU.js";import{I as c,C as d}from"./AntdIcon-BrIVTVC9.js";import{T as x}from"./index-OFQobG-o.js";import{B as j}from"./EllipsisOutlined-B7G7Lika.js";import{R as m}from"./TrophyOutlined-BVPMSDgz.js";import{R as p,C as u}from"./row-KUrmra0O.js";import{S as h}from"./index-CNaFVlZv.js";import{R as g}from"./UserOutlined-BPw5ZWA_.js";import{R as y}from"./TeamOutlined--sib1hVJ.js";import{R as f}from"./ClockCircleOutlined-DBv5AMFe.js";import{F as v,E as k}from"./Table-CcmlabOw.js";import{R as w}from"./CrownOutlined-C1NA_heS.js";import"./EditOutlined-jOoJX1ad.js";import"./CheckOutlined-BLh5wKOq.js";import"./index-ChgZ5ieq.js";import"./TextArea-RvXwFgUf.js";import"./DownOutlined-CLoAI_il.js";import"./index-GvAVA_fY.js";var T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"};function S(){return S=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},S.apply(this,arguments)}const O=(e,s)=>i.createElement(c,S({},e,{ref:s,icon:T})),b=i.forwardRef(O);function L(){const{stats:c,loading:T,fetchStats:S}=(()=>{const{user:s}=e(),[t,o]=i.useState(!1),[c,d]=i.useState(null),x=async()=>{var e,t,i,c,x,j,m,p,u;if(s){o(!0);try{if(!localStorage.getItem("token"))return;const[s,o,h,g]=await Promise.all([a(),r(),n(),l()]),y={users:{total:s.success?(null==(e=s.data)?void 0:e.total)??0:0,active:s.success?(null==(t=s.data)?void 0:t.total)??0:0,newToday:0,levelDistribution:{}},associations:{total:o.success?(null==(i=o.data)?void 0:i.total)??0:0,totalMembers:o.success?(null==(c=o.data)?void 0:c.totalMembers)??0:0,totalPower:o.success?(null==(x=o.data)?void 0:x.totalPower)??0:0,totalLingshi:o.success?(null==(j=o.data)?void 0:j.totalLingshi)??0:0},najie:{total:0,totalLingshi:0,totalItems:0,categoryStats:{}},rankings:{lastUpdate:h.success?(null==(m=h.data)?void 0:m.lastUpdate)??"":"",topAssociations:h.success?(null==(p=h.data)?void 0:p.topAssociations)??[]:[],topPlayers:h.success?(null==(u=h.data)?void 0:u.topPlayers)??[]:[]},system:{uptime:"7天 12小时 30分钟",lastBackup:(new Date).toISOString(),activeTasks:g.success?Object.keys(g.data??{}).length:0}};d(y)}catch(h){}finally{o(!1)}}};return i.useEffect(()=>{x()},[s]),{loading:t,stats:c,fetchStats:x}})(),O=[{title:"排名",key:"rank",width:60,render:(e,t,i)=>s.jsx("div",{style:{textAlign:"center"},children:i+1})},{title:"玩家",key:"name",render:(e,t)=>s.jsx("span",{children:t.name})},{title:"ID",key:"id",render:(e,t)=>s.jsx("span",{children:t.id})},{title:"境界",key:"level",render:(e,i)=>s.jsx("span",{children:t[i.level]})},{title:"战力",key:"power",render:(e,t)=>s.jsx("span",{children:(t.power??0).toLocaleString()})}],L=[{title:"排名",key:"rank",width:60,render:(e,t,i)=>s.jsx("div",{style:{textAlign:"center"},children:i+1})},{title:"宗门",key:"name",render:(e,t)=>s.jsx("span",{children:t.name})},{title:"成员数",key:"members",render:(e,t)=>s.jsx("span",{children:t.members})},{title:"总战力",key:"power",render:(e,t)=>s.jsx("span",{children:(t.power??0).toLocaleString()})},{title:"灵石池",key:"lingshi",render:(e,t)=>s.jsx("span",{children:(t.lingshi??0).toLocaleString()})}];return s.jsxs(o,{direction:"vertical",size:"large",className:"bg-slate-200 p-4",style:{width:"100%"},children:[s.jsx(d,{title:s.jsxs(o,{align:"center",children:[s.jsx(m,{}),s.jsx(x.Text,{strong:!0,children:"数据看板"})]}),extra:s.jsx(j,{onClick:()=>{S()},loading:T,type:"primary",icon:s.jsx(b,{}),children:"刷新"}),children:s.jsx(x.Text,{type:"secondary",children:"修仙界数据总览"})}),c&&s.jsxs(s.Fragment,{children:[s.jsxs(p,{gutter:[16,16],children:[s.jsx(u,{xs:24,md:6,children:s.jsxs(d,{children:[s.jsx(h,{title:"总玩家数",value:c.users.total,prefix:s.jsx(g,{})}),s.jsxs(x.Text,{type:"secondary",children:["活跃: ",c.users.active," | 今日新增: ",c.users.newToday]})]})}),s.jsx(u,{xs:24,md:6,children:s.jsxs(d,{children:[s.jsx(h,{title:"宗门总数",value:c.associations.total,prefix:s.jsx(y,{})}),s.jsxs(x.Text,{type:"secondary",children:["总成员: ",c.associations.totalMembers]})]})}),s.jsx(u,{xs:24,md:6,children:s.jsxs(d,{children:[s.jsx(h,{title:"定时任务总数",value:c.system.activeTasks,prefix:s.jsx(f,{})}),s.jsxs(x.Text,{type:"secondary",children:["运行时间: ",c.system.uptime]})]})}),s.jsx(u,{xs:24,md:6,children:s.jsxs(d,{children:[s.jsx(h,{title:"数据更新时间",value:new Date(c.rankings.lastUpdate).toLocaleString("zh-CN")}),s.jsxs(x.Text,{type:"secondary",children:["最后更新: ",new Date(c.rankings.lastUpdate).toLocaleString("zh-CN")]})]})})]}),s.jsxs(p,{gutter:[16,16],children:[s.jsx(u,{xs:24,lg:12,children:s.jsx(d,{title:s.jsxs(o,{align:"center",children:[s.jsx(m,{})," 玩家排行榜 TOP10"]}),children:s.jsx(v,{columns:O,dataSource:c.rankings.topPlayers.slice(0,10),rowKey:"id",pagination:!1,size:"small",scroll:{x:300,y:300}})})}),s.jsx(u,{xs:24,lg:12,children:s.jsx(d,{title:s.jsxs(o,{align:"center",children:[s.jsx(w,{})," 宗门排行榜 TOP10"]}),children:s.jsx(v,{columns:L,dataSource:c.rankings.topAssociations.slice(0,10),rowKey:"name",pagination:!1,size:"small",scroll:{x:400,y:300}})})})]})]}),!c&&!T&&s.jsx(d,{children:s.jsx(k,{image:k.PRESENTED_IMAGE_SIMPLE,description:s.jsxs(o,{direction:"vertical",children:[s.jsx(x.Text,{children:"暂无数据"}),s.jsx(x.Text,{type:"secondary",children:"请点击刷新按钮获取最新数据"})]})})})]})}export{L as default};
