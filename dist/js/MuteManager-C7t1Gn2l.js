import{d as e,j as s}from"./index-DqAMoLsJ.js";import{r as t}from"./react-vendor-DusJrpQ4.js";import{d as a}from"./dayjs.min-B7aZrnUZ.js";import{B as r,I as c,S as n}from"./XiuxianUserSelector-CWYSj_3H.js";import{X as i}from"./XiuxianStatCard-BVjJiVJS.js";import{X as l}from"./XiuxianPageWrapper-CMQV25rD.js";import{X as o}from"./XiuxianPageTitle-Cl46tS-H.js";import{X as d}from"./XiuxianSearchBar-DFoF-OAr.js";import{X as m}from"./XiuxianTableContainer-BkgqaR6Z.js";import{X as x}from"./XiuxianRefreshButton-DlvBc30_.js";import{X as u}from"./XiuxianEmptyState-B9W0AwHs.js";import{X as h}from"./XiuxianTabGroup-B5lwNCoX.js";import{X as j}from"./XiuxianTableWithPagination-DXtcYx4U.js";import{F as p}from"./index-Cznd2B00.js";import{R as g}from"./PlusOutlined-1GOQRMIA.js";import{R as f}from"./DeleteOutlined-CW6iuLXa.js";import{I as v,S as y}from"./AntdIcon-Bbx31dNn.js";import{R as N,P as b}from"./StopOutlined-B68PwRQt.js";import{a as w}from"./ExclamationCircleOutlined-D2oa8-hT.js";import{M as T}from"./index-BHUym5sn.js";import{s as I}from"./index-BzL8dOnv.js";import{R as C}from"./UserOutlined-DeGkEJrq.js";import{T as S}from"./index-RdA3E1Zy.js";import{R as k}from"./CheckCircleOutlined-BkpFIXed.js";import"./SearchOutlined-hNmY66fv.js";import"./row-BIuOfoI7.js";import"./index-y_F2nvHh.js";import"./index-DIBmgHKN.js";import"./context-BkcXnkCo.js";var O={};Object.defineProperty(O,"__esModule",{value:!0});var X=O.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"};function M(){return M=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},M.apply(this,arguments)}const H=(e,s)=>t.createElement(v,M({},e,{ref:s,icon:X})),z=t.forwardRef(H);var D={};Object.defineProperty(D,"__esModule",{value:!0});var E=D.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"};function P(){return P=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},P.apply(this,arguments)}const Y=(e,s)=>t.createElement(v,P({},e,{ref:s,icon:E})),R=t.forwardRef(Y),{Option:$}=n,V=({visible:c,onCancel:n})=>{const[i,l]=t.useState("mute"),[o,d]=t.useState([]),[m,x]=t.useState(!1),u=async s=>{x(!0);try{const t=await(async(s="mute",t=100)=>{try{const a=await e({url:`/mute-logs?type=${s}&limit=${t}`,method:"GET"});return 200===a.code?{success:!0,data:a.data}:{success:!1,message:a.message}}catch(a){return{success:!1,message:"ç½‘ç»œé”™è¯¯"}}})(s,100);t.success&&t.data?d(t.data.list):I.error(t.message||"èŽ·å–æ—¥å¿—å¤±è´¥")}catch(t){I.error("èŽ·å–æ—¥å¿—å¤±è´¥")}finally{x(!1)}},j=async s=>{try{const t=await(async(s="all")=>{try{const t=await e({url:`/mute-logs?type=${s}`,method:"DELETE"});return 200===t.code?{success:!0,data:t.data}:{success:!1,message:t.message}}catch(t){return{success:!1,message:"ç½‘ç»œé”™è¯¯"}}})(s);t.success?(I.success(t.message||"æ¸…ç†æ—¥å¿—æˆåŠŸ"),u(i)):I.error(t.message||"æ¸…ç†æ—¥å¿—å¤±è´¥")}catch(t){I.error("æ¸…ç†æ—¥å¿—å¤±è´¥")}};t.useEffect(()=>{c&&u(i)},[c,i]);const p=[{name:"mute",icon:s.jsx(N,{}),content:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"ç¦è¨€è®°å½•"}),s.jsx(b,{title:"ç¡®å®šè¦æ¸…ç†ç¦è¨€è®°å½•å—ï¼Ÿ",onConfirm:()=>j("mute"),okText:"ç¡®å®š",cancelText:"å–æ¶ˆ",children:s.jsx(r,{danger:!0,size:"small",children:"æ¸…ç†ç¦è¨€è®°å½•"})})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:m?s.jsx("div",{className:"text-center py-8",children:s.jsx("div",{className:"text-slate-400",children:"åŠ è½½ä¸­..."})}):0===o.length?s.jsx("div",{className:"text-center py-8",children:s.jsx("div",{className:"text-slate-400",children:"æš‚æ— ç¦è¨€è®°å½•"})}):s.jsx("div",{className:"space-y-2",children:o.map((e,t)=>s.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"font-mono text-sm text-white",children:e.userId}),e.reason&&s.jsx(S,{color:"orange",className:"text-xs",children:e.reason}),e.duration&&s.jsxs(S,{color:"blue",className:"text-xs",children:[Math.floor(e.duration/60),"åˆ†é’Ÿ"]})]}),s.jsx("div",{className:"text-slate-400 text-xs",children:a(e.timestamp).format("YYYY-MM-DD HH:mm:ss")})]}),e.adminId&&s.jsxs("div",{className:"text-slate-500 text-xs mt-1",children:["æ“ä½œç®¡ç†å‘˜: ",e.adminId]})]},t))})})]})},{name:"unmute",icon:s.jsx(k,{}),content:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"è§£é™¤è®°å½•"}),s.jsx(b,{title:"ç¡®å®šè¦æ¸…ç†è§£é™¤è®°å½•å—ï¼Ÿ",onConfirm:()=>j("unmute"),okText:"ç¡®å®š",cancelText:"å–æ¶ˆ",children:s.jsx(r,{danger:!0,size:"small",children:"æ¸…ç†è§£é™¤è®°å½•"})})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:m?s.jsx("div",{className:"text-center py-8",children:s.jsx("div",{className:"text-slate-400",children:"åŠ è½½ä¸­..."})}):0===o.length?s.jsx("div",{className:"text-center py-8",children:s.jsx("div",{className:"text-slate-400",children:"æš‚æ— è§£é™¤è®°å½•"})}):s.jsx("div",{className:"space-y-2",children:o.map((e,t)=>s.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"font-mono text-sm text-white",children:e.userId}),e.reason&&s.jsx(S,{color:"green",className:"text-xs",children:e.reason})]}),s.jsx("div",{className:"text-slate-400 text-xs",children:a(e.timestamp).format("YYYY-MM-DD HH:mm:ss")})]}),e.adminId&&s.jsxs("div",{className:"text-slate-500 text-xs mt-1",children:["æ“ä½œç®¡ç†å‘˜: ",e.adminId]})]},t))})})]})}];return s.jsx(T,{title:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(z,{className:"text-blue-400"}),s.jsx("span",{className:"text-white",children:"ç¦è¨€æ—¥å¿—"})]}),open:c,onCancel:n,footer:s.jsxs("div",{className:"flex justify-between",children:[s.jsx(b,{title:"ç¡®å®šè¦æ¸…ç†æ‰€æœ‰æ—¥å¿—å—ï¼Ÿ",onConfirm:()=>j("all"),okText:"ç¡®å®š",cancelText:"å–æ¶ˆ",children:s.jsx(r,{danger:!0,children:"æ¸…ç†æ‰€æœ‰æ—¥å¿—"})}),s.jsx(r,{onClick:n,children:"å…³é—­"})]}),className:"xiuxian-modal",width:900,children:s.jsx(h,{tabs:p,activeTab:i,onTabChange:e=>{l(e),u(e)},className:"mt-4"})})},B=()=>{const[h,v]=t.useState([]),[S,k]=t.useState(!1),[O,X]=t.useState(""),[M,H]=t.useState(1),[D,E]=t.useState(10),[P,Y]=t.useState(0),[B,L]=t.useState([]),[_,A]=t.useState(!1),[F,G]=t.useState(!1),[U]=p.useForm(),q=async()=>{k(!0);try{const s=await(async()=>{try{const s=await e({url:"/mute-list",method:"GET"});return 200===s.code?{success:!0,data:s.data}:{success:!1,message:s.message}}catch(s){return{success:!1,message:"ç½‘ç»œé”™è¯¯"}}})();s.success&&s.data?(v(s.data.list),Y(s.data.total)):I.error(s.message||"èŽ·å–ç¦è¨€åˆ—è¡¨å¤±è´¥")}catch(s){I.error("èŽ·å–ç¦è¨€åˆ—è¡¨å¤±è´¥")}finally{k(!1)}},J=async s=>{try{const t=await(async s=>{try{const t=await e({url:`/mute-list?userId=${s}`,method:"DELETE"});return 200===t.code?{success:!0,data:t.data}:{success:!1,message:t.message}}catch(t){return{success:!1,message:"ç½‘ç»œé”™è¯¯"}}})(s);t.success?(I.success("ç¦è¨€è§£é™¤æˆåŠŸ"),q()):I.error(t.message||"ç¦è¨€è§£é™¤å¤±è´¥")}catch(t){I.error("ç¦è¨€è§£é™¤å¤±è´¥")}},K=h.filter(e=>e.userId.toLowerCase().includes(O.toLowerCase())),W=K.slice((M-1)*D,M*D),Q=[{title:s.jsxs("div",{className:"flex items-center gap-2 text-purple-400 font-bold",children:[s.jsx(C,{className:"text-lg"}),s.jsx("span",{children:"ç”¨æˆ·ID"})]}),dataIndex:"userId",key:"userId",render:e=>s.jsx("span",{className:"font-mono text-sm text-white bg-slate-700/50 px-2 py-1 rounded",children:e})},{title:s.jsxs("div",{className:"flex items-center gap-2 text-orange-400 font-bold",children:[s.jsx(w,{className:"text-lg"}),s.jsx("span",{children:"å‰©ä½™æ—¶é—´"})]}),dataIndex:"remainingTime",key:"remainingTime",render:(e,t)=>s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"text-orange-400 font-medium",children:e})})},{title:s.jsx("div",{className:"flex items-center gap-2 text-blue-400 font-bold",children:s.jsx("span",{children:"è§£é™¤æ—¶é—´"})}),dataIndex:"unlockTime",key:"unlockTime",render:e=>s.jsx("span",{className:"text-slate-300",children:a(e).format("YYYY-MM-DD HH:mm:ss")})},{title:s.jsx("div",{className:"flex items-center gap-2 text-green-400 font-bold",children:s.jsx("span",{children:"æ“ä½œ"})}),key:"action",render:(e,t)=>s.jsx(y,{children:s.jsx(b,{title:"ç¡®å®šè¦è§£é™¤è¯¥ç”¨æˆ·çš„ç¦è¨€å—ï¼Ÿ",onConfirm:()=>J(t.userId),okText:"ç¡®å®š",cancelText:"å–æ¶ˆ",children:s.jsx(r,{type:"text",size:"small",icon:s.jsx(R,{}),className:"text-green-400 hover:text-green-300 hover:bg-green-400/10",children:"è§£é™¤ç¦è¨€"})})})}],Z={selectedRowKeys:B,onChange:e=>{L(e)}};return t.useEffect(()=>{q()},[]),s.jsxs(l,{children:[s.jsx(o,{icon:"ðŸ”‡",title:"ç¦è¨€ç®¡ç†",subtitle:"ç®¡ç†ç³»ç»Ÿä¸­çš„ç”¨æˆ·ç¦è¨€çŠ¶æ€",actions:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(r,{type:"primary",icon:s.jsx(g,{}),onClick:()=>A(!0),className:"bg-gradient-to-r from-red-500 to-pink-500 border-0 hover:from-red-600 hover:to-pink-600",children:"æ·»åŠ ç¦è¨€"}),s.jsxs(r,{danger:!0,icon:s.jsx(f,{}),disabled:0===B.length,onClick:async()=>{if(0!==B.length)try{const s=await(async s=>{try{const t=await e({url:"/mute-list",method:"PUT",data:{userIds:s}});return 200===t.code?{success:!0,data:t.data}:{success:!1,message:t.message}}catch(t){return{success:!1,message:"ç½‘ç»œé”™è¯¯"}}})(B);s.success&&s.data?(I.success(`æ‰¹é‡è§£é™¤ç¦è¨€å®Œæˆï¼ŒæˆåŠŸè§£é™¤ ${s.data.successCount} ä¸ªç”¨æˆ·`),L([]),q()):I.error(s.message||"æ‰¹é‡è§£é™¤ç¦è¨€å¤±è´¥")}catch(s){I.error("æ‰¹é‡è§£é™¤ç¦è¨€å¤±è´¥")}else I.warning("è¯·é€‰æ‹©è¦è§£é™¤ç¦è¨€çš„ç”¨æˆ·")},children:["æ‰¹é‡è§£é™¤ (",B.length,")"]}),s.jsx(r,{icon:s.jsx(z,{}),onClick:()=>G(!0),className:"bg-gradient-to-r from-blue-500 to-cyan-500 border-0 hover:from-blue-600 hover:to-cyan-600",children:"æŸ¥çœ‹æ—¥å¿—"}),s.jsx(x,{loading:S,onClick:q})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx(i,{title:"å½“å‰ç¦è¨€ç”¨æˆ·",value:P,icon:s.jsx(N,{}),gradient:"red"}),s.jsx(i,{title:"å³å°†è§£é™¤",value:h.filter(e=>e.ttl<=3600).length,icon:s.jsx(w,{}),gradient:"orange"}),s.jsx(i,{title:"å·²é€‰æ‹©",value:B.length,icon:s.jsx(R,{}),gradient:"green"})]}),s.jsx(d,{placeholder:"æœç´¢ç”¨æˆ·ID...",value:O,onChange:X,onSearch:()=>{}}),s.jsx(m,{title:"ç¦è¨€åˆ—è¡¨",children:0===K.length?s.jsx(u,{icon:"ðŸ”‡",title:"æš‚æ— ç¦è¨€è®°å½•",description:"å½“å‰æ²¡æœ‰ç”¨æˆ·è¢«ç¦è¨€"}):s.jsx(j,{columns:Q,dataSource:W,rowKey:"userId",loading:S,rowSelection:Z,pagination:{current:M,pageSize:D,total:K.length,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,s)=>`ç¬¬ ${s[0]}-${s[1]} æ¡ï¼Œå…± ${e} æ¡`},onPaginationChange:(e,s)=>{H(e),E(s||10)}})})]}),s.jsx(T,{title:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(N,{className:"text-red-400"}),s.jsx("span",{className:"text-white",children:"æ·»åŠ ç¦è¨€"})]}),open:_,onCancel:()=>A(!1),onOk:()=>U.submit(),okText:"ç¡®å®š",cancelText:"å–æ¶ˆ",className:"xiuxian-modal",width:500,children:s.jsxs(p,{form:U,layout:"vertical",onFinish:async s=>{try{const t=await(async s=>{try{const t=await e({url:"/mute-list",method:"POST",data:s});return 200===t.code?{success:!0,data:t.data}:{success:!1,message:t.message}}catch(t){return{success:!1,message:"ç½‘ç»œé”™è¯¯"}}})(s);t.success?(I.success("ç¦è¨€è®¾ç½®æˆåŠŸ"),A(!1),U.resetFields(),q()):I.error(t.message||"ç¦è¨€è®¾ç½®å¤±è´¥")}catch(t){I.error("ç¦è¨€è®¾ç½®å¤±è´¥")}},className:"mt-4",children:[s.jsx(p.Item,{name:"userId",label:s.jsx("span",{className:"text-slate-300",children:"ç”¨æˆ·ID"}),rules:[{required:!0,message:"è¯·è¾“å…¥ç”¨æˆ·ID"}],children:s.jsx(c,{placeholder:"è¯·è¾“å…¥ç”¨æˆ·ID",className:"xiuxian-input"})}),s.jsx(p.Item,{name:"duration",label:s.jsx("span",{className:"text-slate-300",children:"ç¦è¨€æ—¶é•¿"}),rules:[{required:!0,message:"è¯·è¾“å…¥ç¦è¨€æ—¶é•¿"}],children:s.jsx(c,{placeholder:"ä¾‹å¦‚: 30m, 2h, 3600s",className:"xiuxian-input",addonAfter:s.jsxs(n,{defaultValue:"m",className:"w-20",children:[s.jsx($,{value:"m",children:"åˆ†é’Ÿ"}),s.jsx($,{value:"h",children:"å°æ—¶"}),s.jsx($,{value:"s",children:"ç§’"})]})})}),s.jsx(p.Item,{name:"reason",label:s.jsx("span",{className:"text-slate-300",children:"ç¦è¨€åŽŸå› "}),children:s.jsx(c.TextArea,{placeholder:"è¯·è¾“å…¥ç¦è¨€åŽŸå› ï¼ˆå¯é€‰ï¼‰",rows:3,className:"xiuxian-input"})})]})}),s.jsx(V,{visible:F,onCancel:()=>G(!1)})]})};export{B as default};
