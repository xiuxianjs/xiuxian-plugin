import{g as e,m as t,r as s,K as a,u as n,C as r,c as l,a as i,b as o,d as c,j as d}from"./index-B2-_ZLms.js";import{r as m,b as u}from"./react-vendor-BNT5GVrG.js";import{F as h}from"./index-DD6F8Z9c.js";import{s as x}from"./index-Owlwo0eD.js";import{C as g,u as p,I as f,S as b,B as j}from"./XiuxianUserSelector-V8nxbYv3.js";import{X as v}from"./XiuxianStatCard-BzXO4KsZ.js";import{g as y,i as N,I as w,S as $}from"./AntdIcon-KqtHakU8.js";import{R as S}from"./UserOutlined-Cupqygyo.js";import{d as C}from"./dayjs.min-n4JvDb2F.js";import{X as O}from"./XiuxianTableWithPagination-DApRXYI2.js";import{R as k}from"./CrownOutlined-DaF97WLY.js";import{T as _}from"./index-BDKxg7_F.js";import{R as z}from"./EyeOutlined-1nQWEzYg.js";import{R as I,C as E}from"./row-Cv38SxUN.js";import{M}from"./index-BzulwkGu.js";import{C as T}from"./index-DI31RaMT.js";import{X as R}from"./XiuxianPageWrapper-Zl8u_bfP.js";import{X as B}from"./XiuxianPageTitle-B5ecsZ4O.js";import{X as H}from"./XiuxianTableContainer-B8xoFjcM.js";import{X as D}from"./XiuxianRefreshButton-CzB3HRh7.js";import{R as P}from"./PlusOutlined-CD-RqJCY.js";import"./context-BiMxOUho.js";import"./index-CVjKQClW.js";import"./index-CpfY8D8p.js";import"./PlusOutlined-ByZyTB3m.js";const L=new a("antStatusProcessing",{"0%":{transform:"scale(0.8)",opacity:.5},"100%":{transform:"scale(2.4)",opacity:0}}),F=new a("antZoomBadgeIn",{"0%":{transform:"scale(0) translate(50%, -50%)",opacity:0},"100%":{transform:"scale(1) translate(50%, -50%)"}}),V=new a("antZoomBadgeOut",{"0%":{transform:"scale(1) translate(50%, -50%)"},"100%":{transform:"scale(0) translate(50%, -50%)",opacity:0}}),W=new a("antNoWrapperZoomBadgeIn",{"0%":{transform:"scale(0)",opacity:0},"100%":{transform:"scale(1)"}}),X=new a("antNoWrapperZoomBadgeOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0)",opacity:0}}),A=new a("antBadgeLoadingCircle",{"0%":{transformOrigin:"50%"},"100%":{transform:"translate(50%, -50%) rotate(360deg)",transformOrigin:"50%"}}),Y=e=>{const{fontHeight:s,lineWidth:a,marginXS:n,colorBorderBg:r}=e,l=s,i=a,o=e.colorTextLightSolid,c=e.colorError,d=e.colorErrorHover;return t(e,{badgeFontHeight:l,badgeShadowSize:i,badgeTextColor:o,badgeColor:c,badgeColorHover:d,badgeShadowColor:r,badgeProcessingDuration:"1.2s",badgeRibbonOffset:n,badgeRibbonCornerTransform:"scaleY(0.75)",badgeRibbonCornerFilter:"brightness(75%)"})},G=e=>{const{fontSize:t,lineHeight:s,fontSizeSM:a,lineWidth:n}=e;return{indicatorZIndex:"auto",indicatorHeight:Math.round(t*s)-2*n,indicatorHeightSM:t,dotSize:a/2,textFontSize:a,textFontSizeSM:a,textFontWeight:"normal",statusSize:a/2}},Z=e("Badge",e=>(e=>{const{componentCls:t,iconCls:a,antCls:r,badgeShadowSize:l,textFontSize:i,textFontSizeSM:o,statusSize:c,dotSize:d,textFontWeight:m,indicatorHeight:u,indicatorHeightSM:h,marginXS:x,calc:g}=e,p=`${r}-scroll-number`,f=y(e,(e,{darkColor:s})=>({[`&${t} ${t}-color-${e}`]:{background:s,[`&:not(${t}-count)`]:{color:s},"a:hover &":{background:s}}}));return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},s(e)),{position:"relative",display:"inline-block",width:"fit-content",lineHeight:1,[`${t}-count`]:{display:"inline-flex",justifyContent:"center",zIndex:e.indicatorZIndex,minWidth:u,height:u,color:e.badgeTextColor,fontWeight:m,fontSize:i,lineHeight:n(u),whiteSpace:"nowrap",textAlign:"center",background:e.badgeColor,borderRadius:g(u).div(2).equal(),boxShadow:`0 0 0 ${n(l)} ${e.badgeShadowColor}`,transition:`background ${e.motionDurationMid}`,a:{color:e.badgeTextColor},"a:hover":{color:e.badgeTextColor},"a:hover &":{background:e.badgeColorHover}},[`${t}-count-sm`]:{minWidth:h,height:h,fontSize:o,lineHeight:n(h),borderRadius:g(h).div(2).equal()},[`${t}-multiple-words`]:{padding:`0 ${n(e.paddingXS)}`,bdi:{unicodeBidi:"plaintext"}},[`${t}-dot`]:{zIndex:e.indicatorZIndex,width:d,minWidth:d,height:d,background:e.badgeColor,borderRadius:"100%",boxShadow:`0 0 0 ${n(l)} ${e.badgeShadowColor}`},[`${t}-count, ${t}-dot, ${p}-custom-component`]:{position:"absolute",top:0,insetInlineEnd:0,transform:"translate(50%, -50%)",transformOrigin:"100% 0%",[`&${a}-spin`]:{animationName:A,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&${t}-status`]:{lineHeight:"inherit",verticalAlign:"baseline",[`${t}-status-dot`]:{position:"relative",top:-1,display:"inline-block",width:c,height:c,verticalAlign:"middle",borderRadius:"50%"},[`${t}-status-success`]:{backgroundColor:e.colorSuccess},[`${t}-status-processing`]:{overflow:"visible",color:e.colorInfo,backgroundColor:e.colorInfo,borderColor:"currentcolor","&::after":{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",borderWidth:l,borderStyle:"solid",borderColor:"inherit",borderRadius:"50%",animationName:L,animationDuration:e.badgeProcessingDuration,animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",content:'""'}},[`${t}-status-default`]:{backgroundColor:e.colorTextPlaceholder},[`${t}-status-error`]:{backgroundColor:e.colorError},[`${t}-status-warning`]:{backgroundColor:e.colorWarning},[`${t}-status-text`]:{marginInlineStart:x,color:e.colorText,fontSize:e.fontSize}}}),f),{[`${t}-zoom-appear, ${t}-zoom-enter`]:{animationName:F,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack,animationFillMode:"both"},[`${t}-zoom-leave`]:{animationName:V,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack,animationFillMode:"both"},[`&${t}-not-a-wrapper`]:{[`${t}-zoom-appear, ${t}-zoom-enter`]:{animationName:W,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack},[`${t}-zoom-leave`]:{animationName:X,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack},[`&:not(${t}-status)`]:{verticalAlign:"middle"},[`${p}-custom-component, ${t}-count`]:{transform:"none"},[`${p}-custom-component, ${p}`]:{position:"relative",top:"auto",display:"block",transformOrigin:"50% 50%"}},[p]:{overflow:"hidden",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack}`,[`${p}-only`]:{position:"relative",display:"inline-block",height:u,transition:`all ${e.motionDurationSlow} ${e.motionEaseOutBack}`,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden",[`> p${p}-only-unit`]:{height:u,margin:0,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden"}},[`${p}-symbol`]:{verticalAlign:"top"}},"&-rtl":{direction:"rtl",[`${t}-count, ${t}-dot, ${p}-custom-component`]:{transform:"translate(-50%, -50%)"}}})}})(Y(e)),G),q=e(["Badge","Ribbon"],e=>(e=>{const{antCls:t,badgeFontHeight:a,marginXS:r,badgeRibbonOffset:l,calc:i}=e,o=`${t}-ribbon`,c=`${t}-ribbon-wrapper`,d=y(e,(e,{darkColor:t})=>({[`&${o}-color-${e}`]:{background:t,color:t}}));return{[c]:{position:"relative"},[o]:Object.assign(Object.assign(Object.assign(Object.assign({},s(e)),{position:"absolute",top:r,padding:`0 ${n(e.paddingXS)}`,color:e.colorPrimary,lineHeight:n(a),whiteSpace:"nowrap",backgroundColor:e.colorPrimary,borderRadius:e.borderRadiusSM,[`${o}-text`]:{color:e.badgeTextColor},[`${o}-corner`]:{position:"absolute",top:"100%",width:l,height:l,color:"currentcolor",border:`${n(i(l).div(2).equal())} solid`,transform:e.badgeRibbonCornerTransform,transformOrigin:"top",filter:e.badgeRibbonCornerFilter}}),d),{[`&${o}-placement-end`]:{insetInlineEnd:i(l).mul(-1).equal(),borderEndEndRadius:0,[`${o}-corner`]:{insetInlineEnd:0,borderInlineEndColor:"transparent",borderBlockEndColor:"transparent"}},[`&${o}-placement-start`]:{insetInlineStart:i(l).mul(-1).equal(),borderEndStartRadius:0,[`${o}-corner`]:{insetInlineStart:0,borderBlockEndColor:"transparent",borderInlineStartColor:"transparent"}},"&-rtl":{direction:"rtl"}})}})(Y(e)),G),U=e=>{const{prefixCls:t,value:s,current:a,offset:n=0}=e;let r;return n&&(r={position:"absolute",top:`${n}00%`,left:0}),m.createElement("span",{style:r,className:l(`${t}-only-unit`,{current:a})},s)};function K(e,t,s){let a=e,n=0;for(;(a+10)%10!==t;)a+=s,n+=s;return n}const J=e=>{const{prefixCls:t,count:s,value:a}=e,n=Number(a),r=Math.abs(s),[l,i]=m.useState(n),[o,c]=m.useState(r),d=()=>{i(n),c(r)};let u,h;if(m.useEffect(()=>{const e=setTimeout(d,1e3);return()=>clearTimeout(e)},[n]),l===n||Number.isNaN(n)||Number.isNaN(l))u=[m.createElement(U,Object.assign({},e,{key:n,current:!0}))],h={transition:"none"};else{u=[];const t=n+10,s=[];for(let e=n;e<=t;e+=1)s.push(e);const a=o<r?1:-1,i=s.findIndex(e=>e%10===l);u=(a<0?s.slice(0,i+1):s.slice(i)).map((t,s)=>{const n=t%10;return m.createElement(U,Object.assign({},e,{key:t,value:n,offset:a<0?s-i:s,current:s===i}))}),h={transform:`translateY(${-K(l,n,a)}00%)`}}return m.createElement("span",{className:`${t}-only`,style:h,onTransitionEnd:d},u)};const Q=m.forwardRef((e,t)=>{const{prefixCls:s,count:a,className:n,motionClassName:o,style:c,title:d,show:u,component:h="sup",children:x}=e,g=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s}(e,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),{getPrefixCls:p}=m.useContext(r),f=p("scroll-number",s),b=Object.assign(Object.assign({},g),{"data-show":u,style:c,className:l(f,n,o),title:d});let j=a;if(a&&Number(a)%1==0){const e=String(a).split("");j=m.createElement("bdi",null,e.map((t,s)=>m.createElement(J,{prefixCls:f,count:Number(a),value:t,key:e.length-s})))}return(null==c?void 0:c.borderColor)&&(b.style=Object.assign(Object.assign({},c),{boxShadow:`0 0 0 1px ${c.borderColor} inset`})),x?i(x,e=>({className:l(`${f}-custom-component`,null==e?void 0:e.className,o)})):m.createElement(h,Object.assign({},b,{ref:t}),j)});const ee=m.forwardRef((e,t)=>{var s,a,n,o,c;const{prefixCls:d,scrollNumberPrefixCls:u,children:h,status:x,text:p,color:f,count:b=null,overflowCount:j=99,dot:v=!1,size:y="default",title:w,offset:$,style:S,className:C,rootClassName:O,classNames:k,styles:_,showZero:z=!1}=e,I=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s}(e,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","rootClassName","classNames","styles","showZero"]),{getPrefixCls:E,direction:M,badge:T}=m.useContext(r),R=E("badge",d),[B,H,D]=Z(R),P=b>j?`${j}+`:b,L="0"===P||0===P||"0"===p||0===p,F=null===b||L&&!z,V=(null!=x||null!=f)&&F,W=null!=x||!L,X=v&&!L,A=X?"":P,Y=m.useMemo(()=>(!(null!=A&&""!==A||null!=p&&""!==p)||L&&!z)&&!X,[A,L,z,X,p]),G=m.useRef(b);Y||(G.current=b);const q=G.current,U=m.useRef(A);Y||(U.current=A);const K=U.current,J=m.useRef(X);Y||(J.current=X);const ee=m.useMemo(()=>{if(!$)return Object.assign(Object.assign({},null==T?void 0:T.style),S);const e={marginTop:$[1]};return"rtl"===M?e.left=Number.parseInt($[0],10):e.right=-Number.parseInt($[0],10),Object.assign(Object.assign(Object.assign({},e),null==T?void 0:T.style),S)},[M,$,S,null==T?void 0:T.style]),te=null!=w?w:"string"==typeof q||"number"==typeof q?q:void 0,se=!Y&&(0===p?z:!!p&&!0!==p),ae=se?m.createElement("span",{className:`${R}-status-text`},p):null,ne=q&&"object"==typeof q?i(q,e=>({style:Object.assign(Object.assign({},ee),e.style)})):void 0,re=N(f,!1),le=l(null==k?void 0:k.indicator,null===(s=null==T?void 0:T.classNames)||void 0===s?void 0:s.indicator,{[`${R}-status-dot`]:V,[`${R}-status-${x}`]:!!x,[`${R}-color-${f}`]:re}),ie={};f&&!re&&(ie.color=f,ie.background=f);const oe=l(R,{[`${R}-status`]:V,[`${R}-not-a-wrapper`]:!h,[`${R}-rtl`]:"rtl"===M},C,O,null==T?void 0:T.className,null===(a=null==T?void 0:T.classNames)||void 0===a?void 0:a.root,null==k?void 0:k.root,H,D);if(!h&&V&&(p||W||!F)){const e=ee.color;return B(m.createElement("span",Object.assign({},I,{className:oe,style:Object.assign(Object.assign(Object.assign({},null==_?void 0:_.root),null===(n=null==T?void 0:T.styles)||void 0===n?void 0:n.root),ee)}),m.createElement("span",{className:le,style:Object.assign(Object.assign(Object.assign({},null==_?void 0:_.indicator),null===(o=null==T?void 0:T.styles)||void 0===o?void 0:o.indicator),ie)}),se&&m.createElement("span",{style:{color:e},className:`${R}-status-text`},p)))}return B(m.createElement("span",Object.assign({ref:t},I,{className:oe,style:Object.assign(Object.assign({},null===(c=null==T?void 0:T.styles)||void 0===c?void 0:c.root),null==_?void 0:_.root)}),h,m.createElement(g,{visible:!Y,motionName:`${R}-zoom`,motionAppear:!1,motionDeadline:1e3},({className:e})=>{var t,s;const a=E("scroll-number",u),n=J.current,r=l(null==k?void 0:k.indicator,null===(t=null==T?void 0:T.classNames)||void 0===t?void 0:t.indicator,{[`${R}-dot`]:n,[`${R}-count`]:!n,[`${R}-count-sm`]:"small"===y,[`${R}-multiple-words`]:!n&&K&&K.toString().length>1,[`${R}-status-${x}`]:!!x,[`${R}-color-${f}`]:re});let i=Object.assign(Object.assign(Object.assign({},null==_?void 0:_.indicator),null===(s=null==T?void 0:T.styles)||void 0===s?void 0:s.indicator),ee);return f&&!re&&(i=i||{},i.background=f),m.createElement(Q,{prefixCls:a,show:!Y,motionClassName:e,className:r,count:K,title:te,style:i,key:"scrollNumber"},ne)}),ae))});ee.Ribbon=e=>{const{className:t,prefixCls:s,style:a,color:n,children:i,text:o,placement:c="end",rootClassName:d}=e,{getPrefixCls:u,direction:h}=m.useContext(r),x=u("ribbon",s),g=`${x}-wrapper`,[p,f,b]=q(x,g),j=N(n,!1),v=l(x,`${x}-placement-${c}`,{[`${x}-rtl`]:"rtl"===h,[`${x}-color-${n}`]:j},t),y={},w={};return n&&!j&&(y.background=n,w.color=n),p(m.createElement("div",{className:l(g,d,f,b)},i,m.createElement("div",{className:l(v,f),style:Object.assign(Object.assign({},y),a)},m.createElement("span",{className:`${x}-text`},o),m.createElement("div",{className:`${x}-corner`,style:w}))))};const te=e=>{const{componentCls:t}=e;return{[t]:{"&-horizontal":{[`&${t}`]:{"&-sm":{marginBlock:e.marginXS},"&-md":{marginBlock:e.margin}}}}}},se=e=>{const{componentCls:t,sizePaddingEdgeHorizontal:a,colorSplit:r,lineWidth:l,textPaddingInline:i,orientationMargin:o,verticalMarginInline:c}=e;return{[t]:Object.assign(Object.assign({},s(e)),{borderBlockStart:`${n(l)} solid ${r}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:c,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${n(l)} solid ${r}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${n(e.marginLG)} 0`},[`&-horizontal${t}-with-text`]:{display:"flex",alignItems:"center",margin:`${n(e.dividerHorizontalWithTextGutterMargin)} 0`,color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${r}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${n(l)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${t}-with-text-start`]:{"&::before":{width:`calc(${o} * 100%)`},"&::after":{width:`calc(100% - ${o} * 100%)`}},[`&-horizontal${t}-with-text-end`]:{"&::before":{width:`calc(100% - ${o} * 100%)`},"&::after":{width:`calc(${o} * 100%)`}},[`${t}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:i},"&-dashed":{background:"none",borderColor:r,borderStyle:"dashed",borderWidth:`${n(l)} 0 0`},[`&-horizontal${t}-with-text${t}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${t}-dashed`]:{borderInlineStartWidth:l,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},"&-dotted":{background:"none",borderColor:r,borderStyle:"dotted",borderWidth:`${n(l)} 0 0`},[`&-horizontal${t}-with-text${t}-dotted`]:{"&::before, &::after":{borderStyle:"dotted none none"}},[`&-vertical${t}-dotted`]:{borderInlineStartWidth:l,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${t}-with-text`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},[`&-horizontal${t}-with-text-start${t}-no-default-orientation-margin-start`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${t}-inner-text`]:{paddingInlineStart:a}},[`&-horizontal${t}-with-text-end${t}-no-default-orientation-margin-end`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${t}-inner-text`]:{paddingInlineEnd:a}}})}},ae=e("Divider",e=>{const s=t(e,{dividerHorizontalWithTextGutterMargin:e.margin,sizePaddingEdgeHorizontal:0});return[se(s),te(s)]},e=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS}),{unitless:{orientationMargin:!0}});const ne={small:"sm",middle:"md"},re=e=>{const{getPrefixCls:t,direction:s,className:a,style:n}=o("divider"),{prefixCls:r,type:i="horizontal",orientation:c="center",orientationMargin:d,className:u,rootClassName:h,children:x,dashed:g,variant:f="solid",plain:b,style:j,size:v}=e,y=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s}(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","variant","plain","style","size"]),N=t("divider",r),[w,$,S]=ae(N),C=p(v),O=ne[C],k=!!x,_=m.useMemo(()=>"left"===c?"rtl"===s?"end":"start":"right"===c?"rtl"===s?"start":"end":c,[s,c]),z="start"===_&&null!=d,I="end"===_&&null!=d,E=l(N,a,$,S,`${N}-${i}`,{[`${N}-with-text`]:k,[`${N}-with-text-${_}`]:k,[`${N}-dashed`]:!!g,[`${N}-${f}`]:"solid"!==f,[`${N}-plain`]:!!b,[`${N}-rtl`]:"rtl"===s,[`${N}-no-default-orientation-margin-start`]:z,[`${N}-no-default-orientation-margin-end`]:I,[`${N}-${O}`]:!!O},u,h),M=m.useMemo(()=>"number"==typeof d?d:/^\d+$/.test(d)?Number(d):d,[d]),T={marginInlineStart:z?M:void 0,marginInlineEnd:I?M:void 0};return w(m.createElement("div",Object.assign({className:E,style:Object.assign(Object.assign({},n),j)},y,{role:"separator"}),x&&"vertical"!==i&&m.createElement("span",{className:`${N}-inner-text`,style:T},x)))};var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"};var ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"};function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},oe.apply(this,arguments)}const ce=(e,t)=>m.createElement(w,oe({},e,{ref:t,icon:ie})),de=m.forwardRef(ce);function me(){return me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},me.apply(this,arguments)}const ue=(e,t)=>m.createElement(w,me({},e,{ref:t,icon:le})),he=m.forwardRef(ue);var xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm47.7-395.2l-25.4-5.9V348.6c38 5.2 61.5 29 65.5 58.2.5 4 3.9 6.9 7.9 6.9h44.9c4.7 0 8.4-4.1 8-8.8-6.1-62.3-57.4-102.3-125.9-109.2V263c0-4.4-3.6-8-8-8h-28.1c-4.4 0-8 3.6-8 8v33c-70.8 6.9-126.2 46-126.2 119 0 67.6 49.8 100.2 102.1 112.7l24.7 6.3v142.7c-44.2-5.9-69-29.5-74.1-61.3-.6-3.8-4-6.6-7.9-6.6H363c-4.7 0-8.4 4-8 8.7 4.5 55 46.2 105.6 135.2 112.1V761c0 4.4 3.6 8 8 8h28.4c4.4 0 8-3.6 8-8.1l-.2-31.7c78.3-6.9 134.3-48.8 134.3-124-.1-69.4-44.2-100.4-109-116.4zm-68.6-16.2c-5.6-1.6-10.3-3.1-15-5-33.8-12.2-49.5-31.9-49.5-57.3 0-36.3 27.5-57 64.5-61.7v124zM534.3 677V543.3c3.1.9 5.9 1.6 8.8 2.2 47.3 14.4 63.2 34.4 63.2 65.1 0 39.1-29.4 62.6-72 66.4z"}}]},name:"dollar",theme:"outlined"};function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},ge.apply(this,arguments)}const pe=(e,t)=>m.createElement(w,ge({},e,{ref:t,icon:xe})),fe=m.forwardRef(pe);var be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},je.apply(this,arguments)}const ve=(e,t)=>m.createElement(w,je({},e,{ref:t,icon:be})),ye=m.forwardRef(ve);var Ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"};function we(){return we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},we.apply(this,arguments)}const $e=(e,t)=>m.createElement(w,we({},e,{ref:t,icon:Ne})),Se=m.forwardRef($e),Ce=()=>{const[e,t]=u.useState(!1),[s,a]=u.useState([]),[n,r]=u.useState([]),[l,i]=u.useState(null),[o,d]=u.useState(null),[m,g]=u.useState("users"),[p,f]=u.useState(!1),[b,j]=u.useState(null),[v]=h.useForm(),y=async()=>{const e=await(async()=>{try{const e=await c({url:"/currency/config",method:"GET"});return 200===e.code?{success:!0,data:e.data}:{success:!1,message:e.message||"获取配置信息失败"}}catch(e){return{success:!1,message:"获取配置信息失败"}}})();e.success&&e.data?d(e.data):x.error(e.message||"获取配置信息失败")},N=async()=>{t(!0);try{const e=await(async()=>{try{const e=await c({url:"/currency/users",method:"GET"});return 200===e.code?{success:!0,data:e.data}:{success:!1,message:e.message||"获取用户数据失败"}}catch(e){return{success:!1,message:"获取用户数据失败"}}})();e.success&&e.data?a(e.data):x.error(e.message||"获取用户数据失败")}catch(e){x.error("获取用户数据失败")}t(!1)},w=async()=>{const e=await(async()=>{try{const e=await c({url:"/currency/stats",method:"GET"});return 200===e.code?{success:!0,data:e.data}:{success:!1,message:e.message||"获取统计数据失败"}}catch(e){return{success:!1,message:"获取统计数据失败"}}})();e.success&&e.data?i(e.data):x.error(e.message||"获取统计数据失败")};return u.useEffect(()=>{(async()=>{try{await Promise.all([y(),N(),w()])}catch(e){}})()},[]),{loading:e,users:s,records:n,stats:l,config:o,selectedTab:m,rechargeModalVisible:p,selectedUser:b,rechargeForm:v,setSelectedTab:g,setRechargeModalVisible:f,setSelectedUser:j,fetchUsers:N,fetchRecords:async()=>{t(!0);try{const e=await(async()=>{try{const e=await c({url:"/currency/records",method:"GET"});return 200===e.code?{success:!0,data:e.data.records}:{success:!1,message:e.message||"获取充值记录失败"}}catch(e){return{success:!1,message:"获取充值记录失败"}}})();e.success&&e.data?r(e.data):x.error(e.message||"获取充值记录失败")}catch(e){x.error("获取充值记录失败")}t(!1)},fetchStats:w,fetchConfig:y,handleRechargeOk:async e=>{try{const t=await(async e=>{try{const t=await c({url:"/currency/recharge",method:"POST",data:e});return 201===t.code?{success:!0,data:t.data}:{success:!1,message:t.message||"创建充值记录失败"}}catch(t){return{success:!1,message:"创建充值记录失败"}}})({action:e.type,userId:e.userId,tier:e.tier,paymentMethod:"admin",remark:e.remark});if(t.success&&t.data){const e=await(async e=>{try{const t=await c({url:"/currency/recharge",method:"POST",data:{action:"complete-payment",...e}});return 200===t.code?{success:!0}:{success:!1,message:t.message||"支付完成失败"}}catch(t){return{success:!1,message:"支付完成失败"}}})({recordId:t.data.id,transactionId:"ADMIN_"+Date.now(),paymentMethod:"admin"});e.success?(x.success("充值成功"),f(!1),j(null),v.resetFields(),N(),w()):x.error(e.message||"支付完成失败")}else x.error(t.message||"创建充值记录失败")}catch(t){x.error("充值操作失败，请重试")}}}},Oe=({value:e,onChange:t,options:s,className:a="",size:n="default",variant:r="button"})=>{const l={small:"px-3 py-1.5 text-sm",default:"px-4 py-2 text-base",large:"px-6 py-3 text-lg"},i=e=>{var a;t&&!(null==(a=s.find(t=>t.value===e))?void 0:a.disabled)&&t(e)};return"button"===r?d.jsx("div",{className:`flex gap-2 ${a}`,children:s.map(t=>{const s=e===t.value,a=t.disabled;return d.jsx("button",{type:"button",disabled:a,onClick:()=>i(t.value),className:`\n                ${l[n]}\n                rounded-lg font-medium transition-all duration-200\n                ${s?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":a?"bg-slate-800/30 text-slate-500 border border-slate-700 cursor-not-allowed":"bg-slate-700/50 text-slate-300 border border-slate-600 hover:bg-slate-600/50 hover:text-white hover:border-slate-500"}\n                focus:outline-none focus:ring-2 focus:ring-purple-500/50\n              `,children:t.label},t.value)})}):d.jsx("div",{className:`space-y-2 ${a}`,children:s.map(t=>{const s=e===t.value,a=t.disabled;return d.jsxs("label",{className:`\n              flex items-center gap-3 cursor-pointer transition-all duration-200\n              ${a?"cursor-not-allowed opacity-50":"hover:text-white"}\n            `,children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"radio",value:t.value,checked:s,disabled:a,onChange:()=>i(t.value),className:"sr-only"}),d.jsx("div",{className:`\n                  w-4 h-4 border-2 rounded-full flex items-center justify-center\n                  transition-all duration-200\n                  ${s?"border-purple-500 bg-purple-500":a?"border-slate-600 bg-slate-800":"border-slate-500 bg-slate-700 hover:border-slate-400"}\n                `,children:s&&d.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]}),d.jsx("span",{className:"text-sm "+(s?"text-white":"text-slate-300"),children:t.label})]},t.value)})})};function ke({stats:e}){return d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[d.jsx(v,{title:"总充值金额",value:`¥${e.total_amount.toLocaleString()}`,icon:d.jsx(de,{}),gradient:"green"}),d.jsx(v,{title:"总充值次数",value:e.total_count.toLocaleString(),icon:d.jsx(de,{}),gradient:"blue"}),d.jsx(v,{title:"首充用户数",value:e.first_recharge_users.toLocaleString(),icon:d.jsx(de,{}),gradient:"purple"}),d.jsx(v,{title:"今日充值",value:`¥${e.today_amount.toLocaleString()}`,icon:d.jsx(de,{}),gradient:"orange"})]})}function _e({selectedTab:e,onTabChange:t,onRecordsTabClick:s}){const a=[{name:"users",icon:d.jsx(S,{}),content:null},{name:"records",icon:d.jsx(Se,{}),content:null},{name:"stats",icon:d.jsx(de,{}),content:null}];return d.jsx("div",{className:"mb-6",children:d.jsx("div",{className:"flex gap-4",children:a.map(a=>d.jsxs("button",{className:"px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2 "+(e===a.name?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":"bg-slate-700/50 hover:bg-slate-600/50 text-slate-300 border border-slate-600"),onClick:()=>{var e;"records"===(e=a.name)?s():t(e)},children:[a.icon,"users"===a.name&&"用户货币","records"===a.name&&"充值记录","stats"===a.name&&"统计分析"]},a.name))})})}function ze({users:e,loading:t,onRefresh:s,onStatsRefresh:a}){const[n,r]=u.useState(""),l=[{title:"用户ID",dataIndex:"id",key:"id",width:120,render:e=>d.jsx("div",{className:"font-mono text-sm bg-slate-700/50 px-2 py-1 rounded",children:e})},{title:"金币余额",dataIndex:"currency",key:"currency",width:120,render:e=>d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(fe,{className:"text-yellow-400"}),d.jsx("span",{className:"font-bold text-yellow-400",children:e.toLocaleString()})]})},{title:"月卡状态",key:"monthCards",width:200,render:(e,t)=>d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(he,{className:"text-blue-400"}),d.jsx("span",{className:"text-sm",children:"小月卡:"}),d.jsx(ee,{count:C(t.small_month_card_expire_time).diff(C(),"day")+1,showZero:!0,color:t.small_month_card_expire_time>Date.now()?"blue":"default"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(k,{className:"text-purple-400"}),d.jsx("span",{className:"text-sm",children:"大月卡:"}),d.jsx(ee,{count:C(t.big_month_card_expire_time).diff(C(),"day")+1,showZero:!0,color:t.big_month_card_expire_time>Date.now()?"purple":"default"})]})]})},{title:"充值信息",key:"rechargeInfo",width:180,render:(e,t)=>d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{className:"text-sm",children:[d.jsx("span",{className:"text-slate-400",children:"总充值:"}),d.jsxs("span",{className:"text-green-400 font-bold ml-1",children:["¥",t.total_recharge_amount]})]}),d.jsxs("div",{className:"text-sm",children:[d.jsx("span",{className:"text-slate-400",children:"充值次数:"}),d.jsx("span",{className:"text-blue-400 font-bold ml-1",children:t.total_recharge_count})]}),t.is_first_recharge&&d.jsx(_,{color:"gold",icon:d.jsx(ye,{}),children:"首充用户"})]})},{title:"时间信息",key:"timeInfo",width:200,render:(e,t)=>d.jsxs("div",{className:"space-y-1 text-xs",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-400",children:"最后充值:"}),d.jsx("div",{className:"text-slate-300",children:t.last_recharge_time?C(t.last_recharge_time).format("YYYY-MM-DD HH:mm"):"无"})]}),t.first_recharge_time&&d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-400",children:"首充时间:"}),d.jsx("div",{className:"text-slate-300",children:C(t.first_recharge_time).format("YYYY-MM-DD HH:mm")})]})]})}],i=e.filter(e=>e.id.toLowerCase().includes(n.toLowerCase()));return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[d.jsx("div",{className:"flex-1 min-w-0",children:d.jsx(f.Search,{placeholder:"输入关键词搜索...",value:n,onChange:e=>r(e.target.value),onSearch:()=>{},size:"large",onKeyPress:e=>"Enter"===e.key&&r(e.target.value),className:"w-full xiuxian-input"})}),d.jsxs("div",{className:"text-slate-400 text-sm",children:["共 ",i.length," 个用户"]})]}),d.jsx(O,{columns:l,dataSource:i,loading:t,rowKey:"id",pagination:{current:1,pageSize:20,total:i.length,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`},rowClassName:()=>"bg-slate-700 hover:bg-slate-600"})]})}const{Option:Ie}=b;function Ee({records:e,loading:t,config:s}){const[a,n]=u.useState(""),[r,l]=u.useState(""),[i,o]=u.useState(""),c=[{title:"记录ID",dataIndex:"id",key:"id",width:100,render:e=>d.jsx("div",{className:"font-mono text-xs bg-slate-700/50 px-2 py-1 rounded",children:e})},{title:"用户ID",dataIndex:"user_id",key:"user_id",width:120,render:e=>d.jsx("div",{className:"font-mono text-sm bg-slate-700/50 px-2 py-1 rounded",children:e})},{title:"充值类型",dataIndex:"type",key:"type",width:120,render:(e,t)=>d.jsxs("div",{className:"space-y-1",children:[d.jsx(_,{color:Me(e),children:Te(e)}),t.tier&&d.jsx("div",{className:"text-xs text-slate-400",children:t.tier})]})},{title:"充值金额",dataIndex:"tier",key:"amount",width:120,render:(e,t)=>{const a=(e=>{var t,a,n,r,l;if(!s)return 0;if(e===(null==(a=null==(t=s.monthCardConfig)?void 0:t.SMALL)?void 0:a.name))return s.monthCardConfig.SMALL.price;if(e===(null==(r=null==(n=s.monthCardConfig)?void 0:n.BIG)?void 0:r.name))return s.monthCardConfig.BIG.price;const i=null==(l=s.rechargeTiers)?void 0:l.find(t=>t.name===e);return(null==i?void 0:i.amount)||0})(e);return d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{className:"font-bold text-green-400",children:["¥",a]}),t.currency_gained>0&&d.jsxs("div",{className:"text-xs text-yellow-400",children:["获得金币: ",t.currency_gained.toLocaleString()]}),t.month_card_days>0&&d.jsxs("div",{className:"text-xs text-blue-400",children:["月卡天数: ",t.month_card_days,"天"]})]})}},{title:"支付状态",dataIndex:"payment_status",key:"payment_status",width:100,render:e=>d.jsx(_,{color:Re(e),children:Be(e)})},{title:"支付信息",key:"paymentInfo",width:150,render:(e,t)=>d.jsxs("div",{className:"space-y-1 text-xs",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-400",children:"方式:"}),d.jsx("span",{className:"text-slate-300 ml-1",children:t.payment_method})]}),t.transaction_id&&d.jsxs("div",{className:"font-mono text-slate-400",children:[t.transaction_id.slice(0,8),"..."]})]})},{title:"时间信息",key:"timeInfo",width:180,render:(e,t)=>d.jsxs("div",{className:"space-y-1 text-xs",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-400",children:"创建:"}),d.jsx("div",{className:"text-slate-300",children:C(t.created_at).format("MM-DD HH:mm")})]}),t.paid_at&&d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-400",children:"支付:"}),d.jsx("div",{className:"text-slate-300",children:C(t.paid_at).format("MM-DD HH:mm")})]})]})},{title:"特殊标记",key:"special",width:100,render:(e,t)=>d.jsxs("div",{className:"space-y-1",children:[t.is_first_recharge&&d.jsx(_,{color:"gold",icon:d.jsx(ye,{}),children:"首充"}),t.first_recharge_bonus>0&&d.jsxs("div",{className:"text-xs text-yellow-400",children:["奖励: +",t.first_recharge_bonus]})]})},{title:"操作",key:"actions",width:100,render:(e,t)=>d.jsx($,{children:d.jsx(j,{size:"small",icon:d.jsx(z,{}),onClick:()=>{},children:"详情"})})}],m=e.filter(e=>{const t=e.user_id.toLowerCase().includes(a.toLowerCase())||e.id.toLowerCase().includes(a.toLowerCase()),s=!r||e.payment_status===r,n=!i||e.type===i;return t&&s&&n});return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[d.jsx("div",{className:"flex-1 min-w-0",children:d.jsx(f.Search,{placeholder:"搜索用户ID或记录ID",className:"w-full xiuxian-input",value:a,onChange:e=>n(e.target.value),onSearch:()=>{},onKeyPress:e=>"Enter"===e.key&&n(e.target.value)})}),d.jsxs(b,{placeholder:"支付状态",allowClear:!0,className:"xiuxian-select",style:{width:120},onChange:l,children:[d.jsx(Ie,{value:"pending",children:"待支付"}),d.jsx(Ie,{value:"success",children:"支付成功"}),d.jsx(Ie,{value:"failed",children:"支付失败"}),d.jsx(Ie,{value:"refunded",children:"已退款"})]}),d.jsxs(b,{placeholder:"充值类型",allowClear:!0,className:"xiuxian-select",style:{width:120},onChange:o,children:[d.jsx(Ie,{value:"currency",children:"金币充值"}),d.jsx(Ie,{value:"small_month_card",children:"小月卡"}),d.jsx(Ie,{value:"big_month_card",children:"大月卡"}),d.jsx(Ie,{value:"combo",children:"组合充值"})]}),d.jsxs("div",{className:"text-slate-400 text-sm",children:["共 ",m.length," 条记录"]})]}),d.jsx(O,{columns:c,dataSource:m,loading:t,rowKey:"id",pagination:{current:1,pageSize:20,total:m.length,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`},rowClassName:()=>"bg-slate-700 hover:bg-slate-600"})]})}function Me(e){switch(e){case"currency":return"green";case"small_month_card":return"blue";case"big_month_card":return"purple";case"combo":return"orange";default:return"default"}}function Te(e){switch(e){case"currency":return"金币充值";case"small_month_card":return"小月卡";case"big_month_card":return"大月卡";case"combo":return"组合充值";default:return e}}function Re(e){switch(e){case"pending":return"orange";case"success":return"green";case"failed":return"red";case"refunded":return"gray";default:return"default"}}function Be(e){switch(e){case"pending":return"待支付";case"success":return"支付成功";case"failed":return"支付失败";case"refunded":return"已退款";default:return e}}function He({stats:e}){return e?d.jsxs("div",{className:"space-y-6",children:[d.jsxs(I,{gutter:16,children:[d.jsx(E,{span:12,children:d.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-6 shadow-lg",children:[d.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[d.jsx(fe,{className:"text-green-400"}),"充值金额统计"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"总充值金额"}),d.jsxs("span",{className:"text-2xl font-bold text-green-400",children:["¥",e.total_amount.toLocaleString()]})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"本月充值金额"}),d.jsxs("span",{className:"text-xl font-bold text-blue-400",children:["¥",e.month_amount.toLocaleString()]})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"今日充值金额"}),d.jsxs("span",{className:"text-lg font-bold text-orange-400",children:["¥",e.today_amount.toLocaleString()]})]})]})]})}),d.jsx(E,{span:12,children:d.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-6 shadow-lg",children:[d.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[d.jsx(de,{className:"text-blue-400"}),"充值次数统计"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"总充值次数"}),d.jsx("span",{className:"text-2xl font-bold text-blue-400",children:e.total_count.toLocaleString()})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"本月充值次数"}),d.jsx("span",{className:"text-xl font-bold text-purple-400",children:e.month_count.toLocaleString()})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"今日充值次数"}),d.jsx("span",{className:"text-lg font-bold text-cyan-400",children:e.today_count.toLocaleString()})]})]})]})})]}),d.jsxs(I,{gutter:16,children:[d.jsx(E,{span:12,children:d.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-6 shadow-lg",children:[d.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[d.jsx(S,{className:"text-yellow-400"}),"用户统计"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"首充用户数"}),d.jsx("span",{className:"text-2xl font-bold text-yellow-400",children:e.first_recharge_users.toLocaleString()})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"平均充值金额"}),d.jsxs("span",{className:"text-xl font-bold text-green-400",children:["¥",e.total_count>0?(e.total_amount/e.total_count).toFixed(2):"0.00"]})]})]})]})}),d.jsx(E,{span:12,children:d.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-6 shadow-lg",children:[d.jsxs("h4",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[d.jsx(Se,{className:"text-purple-400"}),"系统信息"]}),d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-slate-400",children:"最后更新"}),d.jsx("span",{className:"text-sm text-slate-300",children:C(e.updated_at).format("YYYY-MM-DD HH:mm:ss")})]})})]})})]})]}):d.jsx("div",{children:"暂无数据"})}const{Option:De}=b;function Pe({visible:e,user:t,onCancel:s,onOk:a,form:n,config:r,users:l=[]}){var i;const[o,c]=m.useState("currency"),[u,x]=m.useState(""),[g,p]=m.useState(""),[j,v]=m.useState(null),[y,N]=m.useState(null),[w,$]=m.useState("select");m.useEffect(()=>{e&&(n.resetFields(),c("currency"),x((null==t?void 0:t.id)||""),N(t),p(""),v(null),$("select"))},[e,n,t]),m.useEffect(()=>{if(g&&(null==r?void 0:r.rechargeTiers)){const e=r.rechargeTiers.find(e=>e.name===g);e&&v(e)}else g&&(null==r?void 0:r.monthCardConfig)&&(g===r.monthCardConfig.SMALL.name?v(r.monthCardConfig.SMALL):g===r.monthCardConfig.BIG.name&&v(r.monthCardConfig.BIG))},[g,r]);const S=e=>{x(e);const t=l.find(t=>t.id===e);N(t||null),n.setFieldsValue({userId:e})},O=e=>{const t=e.target.value;x(t),N(null),n.setFieldsValue({userId:t})},z=()=>d.jsx(h.Item,{name:"userId",label:d.jsx("span",{className:"text-slate-300",children:"用户ID"}),rules:[{required:!0,message:"请输入或选择用户ID"}],children:d.jsxs("div",{className:"space-y-3",children:[d.jsx(Oe,{value:w,onChange:e=>($(e),x(""),N(null),void n.setFieldsValue({userId:void 0})),options:[{value:"select",label:"从列表选择"},{value:"manual",label:"手动输入"}],variant:"button",size:"small",className:"mb-3"}),"select"===w?d.jsx(b,{showSearch:!0,placeholder:"搜索并选择用户",value:u,onChange:S,filterOption:(e,t)=>{const s=null==t?void 0:t.children;return"string"==typeof s&&s.toLowerCase().includes(e.toLowerCase())},className:"xiuxian-select",dropdownRender:e=>d.jsxs("div",{children:[e,d.jsx(re,{style:{margin:"8px 0"}}),d.jsxs("div",{className:"px-3 py-2 text-xs text-slate-400",children:["共 ",l.length," 个用户"]})]}),children:l.map(e=>d.jsx(De,{value:e.id,children:d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-mono text-sm",children:e.id}),e.is_first_recharge&&d.jsxs(_,{color:"gold",children:[d.jsx(k,{})," 首充"]})]}),d.jsxs("div",{className:"text-xs text-slate-400",children:["¥",e.currency," | ",e.total_recharge_count,"次"]})]})},e.id))}):d.jsx(f,{placeholder:"请输入用户ID",value:u,onChange:O,className:"xiuxian-input"})]})});return d.jsx(M,{title:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(fe,{className:"text-purple-400"}),d.jsx("span",{className:"text-white",children:"用户充值"})]}),open:e,onCancel:s,onOk:()=>n.submit(),width:700,className:"xiuxian-modal",children:d.jsxs(h,{form:n,layout:"vertical",onFinish:a,children:[d.jsx(z,{}),y&&d.jsx(T,{className:"mb-4 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border-blue-500/20",size:"small",children:d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{className:"text-slate-300",children:[d.jsxs("div",{children:["用户ID: ",d.jsx("span",{className:"text-white font-mono",children:y.id})]}),d.jsxs("div",{children:["金币余额: ",d.jsx("span",{className:"text-yellow-400",children:y.currency.toLocaleString()})]}),d.jsxs("div",{children:["总充值: ",d.jsxs("span",{className:"text-green-400",children:["¥",y.total_recharge_amount]})]})]}),d.jsxs("div",{className:"text-slate-300",children:[d.jsxs("div",{children:["充值次数: ",d.jsx("span",{className:"text-blue-400",children:y.total_recharge_count})]}),d.jsxs("div",{children:["小月卡: ",d.jsxs("span",{className:"text-blue-400",children:[C(y.small_month_card_expire_time).diff(C(),"day")+1,"天"]})]}),d.jsxs("div",{children:["大月卡: ",d.jsxs("span",{className:"text-purple-400",children:[C(y.big_month_card_expire_time).diff(C(),"day")+1,"天"]})]})]})]})}),d.jsx(h.Item,{name:"type",label:d.jsx("span",{className:"text-slate-300",children:"充值类型"}),rules:[{required:!0,message:"请选择充值类型"}],children:d.jsxs(b,{onChange:e=>{c(e),p(""),v(null),n.setFieldsValue({tier:void 0})},className:"xiuxian-select",children:[d.jsx(De,{value:"recharge-currency",children:"金币充值"}),d.jsx(De,{value:"recharge-small-month-card",children:"小月卡"}),d.jsx(De,{value:"recharge-big-month-card",children:"大月卡"})]})}),"recharge-currency"===o&&d.jsx(h.Item,{name:"tier",label:d.jsx("span",{className:"text-slate-300",children:"充值档位"}),rules:[{required:!0,message:"请选择充值档位"}],children:d.jsx(b,{onChange:e=>{p(e),n.setFieldsValue({tier:e})},className:"xiuxian-select",placeholder:"请选择充值档位",children:null==(i=null==r?void 0:r.rechargeTiers)?void 0:i.map(e=>d.jsxs(De,{value:e.name,children:[e.name," (¥",e.amount,")"]},e.key))})}),j&&d.jsx(T,{className:"mb-4 bg-gradient-to-r from-purple-500/10 to-pink-500/10 border-purple-500/20",size:"small",children:d.jsxs("div",{className:"text-center",children:[d.jsx("h4",{className:"text-white font-semibold mb-2",children:j.name}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{className:"text-slate-300",children:[d.jsxs("div",{children:["价格: ",d.jsxs("span",{className:"text-yellow-400",children:["¥",j.amount||j.price]})]}),j.currencyGained&&d.jsxs("div",{children:["获得金币: ",d.jsx("span",{className:"text-green-400",children:j.currencyGained})]}),j.days&&d.jsxs("div",{children:["月卡天数: ",d.jsxs("span",{className:"text-blue-400",children:[j.days,"天"]})]})]}),d.jsxs("div",{className:"text-slate-300",children:[j.firstRechargeBonus&&d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(ye,{className:"text-pink-400"}),"首充奖励: ",d.jsxs("span",{className:"text-pink-400",children:[j.firstRechargeBonus,"金币"]})]}),(null==y?void 0:y.is_first_recharge)&&d.jsxs(_,{color:"gold",className:"mt-1",children:[d.jsx(k,{})," 首充用户"]})]})]})]})}),d.jsx(h.Item,{name:"remark",label:d.jsx("span",{className:"text-slate-300",children:"备注"}),children:d.jsx(f.TextArea,{rows:3,placeholder:"可选备注信息",className:"xiuxian-input"})})]})})}function Le(){const{loading:e,users:t,records:s,stats:a,config:n,selectedTab:r,rechargeModalVisible:l,selectedUser:i,rechargeForm:o,setSelectedTab:c,setRechargeModalVisible:u,setSelectedUser:h,fetchUsers:x,fetchRecords:g,fetchStats:p,fetchConfig:f,handleRechargeOk:b}=Ce();m.useEffect(()=>{x(),p()},[]);return d.jsxs(R,{children:[d.jsx(B,{icon:d.jsx(fe,{}),title:"货币管理系统",subtitle:"管理用户金币、月卡和充值记录",actions:d.jsxs("div",{className:"flex gap-2",children:[d.jsxs("button",{className:"px-2 py-1 rounded-md bg-gradient-to-r from-green-500 to-emerald-500 text-white hover:from-green-600 hover:to-emerald-600 transition-all duration-200 shadow-lg hover:shadow-xl flex items-center gap-2",onClick:()=>{h(null),u(!0)},children:[d.jsx(P,{}),"充值"]}),d.jsx(D,{loading:e,onClick:()=>{x(),g(),p(),f()}})]})}),a&&d.jsx(ke,{stats:a}),d.jsx(_e,{selectedTab:r,onTabChange:c,onRecordsTabClick:()=>{c("records"),g()}}),d.jsxs(H,{title:("users"===r?"用户货币管理":"records"===r&&"充值记录管理")||"stats"===r&&"统计分析"||"货币管理",icon:d.jsx(fe,{}),children:["users"===r&&d.jsx(ze,{users:t,loading:e,onRefresh:x,onStatsRefresh:p}),"records"===r&&d.jsx(Ee,{records:s,loading:e,config:n}),"stats"===r&&d.jsx(He,{stats:a})]}),d.jsx(Pe,{visible:l,user:i,config:n,users:t,onCancel:()=>{u(!1),h(null),o.resetFields()},onOk:b,form:o})]})}export{Le as default};
